<style>
#spa-home, #posts, .homepage, #page-404, .post-content {Â 
Â  display: none;Â 
}

@keyframes slideDown {
Â  from { opacity: 0; transform: translateY(-20px); }
Â  to { opacity: 1; transform: translateY(0); }
}

@keyframes slideOut {
Â  from { opacity: 1; transform: translateY(0); }
Â  to { opacity: 0; transform: translateY(20px); }
}

.animate-slide {
Â  display: block !important;
Â  animation: slideDown 4s ease-out forwards; /* Durasi dipercepat agar sinkron */
}

.animate-out {
Â  display: block !important;
Â  animation: slideOut 3s ease-in forwards;
}
</style>

<div id="page-404" style="display:none;">
Â  Â  <h1>404</h1>
Â  Â  <p>Halaman tidak ditemukan.</p>
Â  Â  <a href="/">Kembali ke Home</a>
</div>

<div id="posts">
<div class="list-title"><h1>Blog:</h1></div>
{% for post in site.posts %}
Â  <article class="post" data-url="{{ post.url | relative_url }}">
Â  Â  <h2 class="post-title">
Â  Â  Â  <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
Â  Â  </h2>

Â  Â  <div class="post-excerpt">
Â  Â  Â  {% if post.description %}
Â  Â  Â  Â  {{ post.description }}
Â  Â  Â  {% else %}
Â  Â  Â  Â  {{ post.excerpt | strip_html | truncatewords: 25 }}
Â  Â  Â  {% endif %}
Â  Â  </div>

Â  Â  <div class="post-content">
Â  Â  Â  {% include post-meta.html post=post %}
Â  Â  Â  <div class="entry-content">
Â  Â  Â  Â  {{ post.content | markdownify }}
Â  Â  Â  </div>
Â  Â  </div>
Â  </article>
{% endfor %}
</div>

<div id="spa-debug" style="
Â  display: visible;
Â  position: fixed;
Â  max-height: 100px;
Â  overflow: auto;
Â  left: 10px;
Â  bottom: 10px;
Â  right: 10px;
Â  padding: 8px 10px;
Â  font: 12px monospace;
Â  background: darkblue;
Â  color: lightgreen;
Â  z-index: 9;
Â  border-radius: 4px;
"></div>

<script>Â Â 
document.addEventListener('DOMContentLoaded', () => {
Â  const homepageÂ  = document.querySelector('.homepage');
Â  const btnÂ  Â  Â  Â = document.getElementById('open-blog');
Â  const postsWrap = document.getElementById('posts');
Â  const page404Â  Â = document.getElementById('page-404');
Â  const debugBoxÂ  = document.getElementById('spa-debug');

Â  const listTitle = document.querySelector('.list-title');
Â  const BLOG_PATH = '/blog/';
Â  let STATEÂ  Â  Â  Â = '';

function getPosts() {
Â  Â  return [...document.querySelectorAll('.post')];Â Â 
Â  }

Â  const safe = (el, fn) => el && fn(el);

function hideAll() {Â Â 
Â  const containers = [document.getElementById('spa-home'), homepage, postsWrap, page404];
Â  containers.forEach(el => safe(el, e => {
Â  Â  e.style.display = 'none';
Â  Â  e.classList.remove('animate-slide', 'animate-out'); // Tambahkan animate-out di sini
Â  Â  void e.offsetWidth;Â 
Â  }));

Â  getPosts().forEach(p => {Â Â 
Â  Â  p.style.display = 'none';
Â  Â  p.classList.remove('animate-slide', 'animate-out'); // Dan di sini
Â  Â Â 
Â  Â  const c = p.querySelector('.post-content');Â Â 
Â  Â  const a = p.querySelector('.post-title a');Â Â 
Â  Â  if (c) c.style.display = 'none';Â 
Â  Â  if (a) a.style.display = '';Â  Â  Â 
Â  });Â Â 
}

Â  function push(path) {Â Â 
Â  Â  if (location.pathname !== path) {Â Â 
Â  Â  Â  history.pushState(null, '', path);Â Â 
Â  Â  }Â Â 
Â  }Â Â 
Â Â 
Â  /* ---------------- renderers ---------------- */Â Â 
Â Â 
function renderHome(pushState) {Â Â 
Â  STATE = 'home';Â Â 
Â  hideAll();Â 

Â  const jekyllWrapper = document.getElementById('spa-home');
Â  safe(jekyllWrapper, el => {
Â  Â  el.style.display = 'block';
Â  Â  el.classList.add('animate-slide'); // Tambahkan ini
Â  });Â 
Â Â 
Â  safe(homepage, el => {
Â  Â  el.style.display = 'block';
Â  Â  el.classList.add('animate-slide'); // Tambahkan ini
Â  });Â Â 

Â  if (pushState) push('/');Â Â 
Â  debug();Â Â 
}

function renderList(pushState) {Â Â 
Â  Â  STATE = 'list';Â Â 
Â  Â  hideAll();Â 

Â  Â  // Tampilkan judul tanpa animasi individu
Â  Â  safe(listTitle, el => el.style.display = 'block');

Â  Â  // Tampilkan pembungkus utama (#posts) dan beri animasi di sini
Â  Â  safe(postsWrap, el => {
Â  Â  Â  Â  el.style.display = 'block';
Â  Â  Â  Â  el.classList.add('animate-slide'); // Seluruh area blog meluncur!
Â  Â  });Â Â 
Â  Â Â 
Â  Â  getPosts().forEach(p => {
Â  Â  Â  Â  p.style.display = 'block';
Â  Â  Â  Â  // Reset elemen dalam post
Â  Â  Â  Â  const ex = p.querySelector('.post-excerpt');
Â  Â  Â  Â  if (ex) ex.style.display = 'block';
Â  Â  Â  Â  const c = p.querySelector('.post-content');
Â  Â  Â  Â  if (c) c.style.display = 'none';
Â  Â  });

Â  Â  if (pushState) push(BLOG_PATH);Â Â 
Â  Â  debug();Â Â 
}

function renderPost(post, pushState) {Â Â 
Â  Â  STATE = 'post';Â Â 
Â  Â  hideAll();
Â  Â Â 
Â  Â  // Sembunyikan judul "Blog:"
Â  Â  safe(listTitle, el => el.style.display = 'none');
Â  Â Â 
Â  Â  // Tampilkan pembungkus postingan
safe(postsWrap, el => {
Â  Â  Â  Â  el.style.display = 'block';
Â  Â  Â  Â  el.classList.add('animate-slide'); // Tambahkan animasi ke pembungkus
Â  Â  });
Â  Â Â 
Â  Â  // Tampilkan artikel yang diklik
Â  Â  post.style.display = 'block';
Â  Â  post.classList.add('animate-slide');

Â  Â  // CARI dan SEMBUNYIKAN excerpt khusus milik postingan ini saja
Â  Â  const thisExcerpt = post.querySelector('.post-excerpt');
Â  Â  if (thisExcerpt) thisExcerpt.style.display = 'none';

Â  Â  // Tampilkan konten utama
Â  Â  const c = post.querySelector('.post-content');Â Â 
Â  Â  const a = post.querySelector('.post-title a');Â Â 
Â  Â  if (c) c.style.display = 'block';Â Â 
Â  Â  if (a) a.style.display = 'none';Â Â 
Â Â 
Â  Â  if (pushState) push(post.dataset.url);Â Â 
Â  Â  debug();Â Â 
}

Â  function render404(path, pushState) {Â Â 
Â  Â  STATE = '404';Â Â 
Â  Â  hideAll();Â Â 
Â  Â  safe(page404, el => el.style.display = 'block');Â Â 
Â  Â  if (pushState) push(path);Â Â 
Â  Â  debug();Â Â 
Â  }Â Â 
Â Â 
Â  /* ---------------- router + debug ---------------- */Â Â 

function findPostByPath(path) {Â Â 
Â  const posts = getPosts();Â Â 
Â  let found = null;Â Â 

Â  posts.forEach(p => {Â Â 
Â  Â  const postUrl = p.dataset.url;Â Â 
Â  Â  if (!postUrl) return;

Â  Â  // Pastikan kita tidak mencocokkan halaman daftar sebagai postingan
Â  Â  if (postUrl.includes('blog.html')) return;Â 

Â  Â  const match = path.endsWith(postUrl);Â Â 
Â  Â  if (match) found = p;Â Â 

Â  Â  // Logging ke Debug Box sesuai permintaan
Â  Â  safe(debugBox, box => {Â Â 
Â  Â  Â  box.innerHTML += `[CHECK] path: ${path} | post: ${postUrl} | result: ${match}<br>`;Â Â 
Â  Â  });Â Â 
Â  });Â Â 

Â  return found;Â Â 
}

/* ---------------- router (Sudah Diperbaiki) ---------------- */Â Â 

function router(path = location.pathname, pushState = false) {Â Â 
Â  // Deteksi kontainer yang sedang tampil saat ini (berdasarkan class atau display)
Â  const currentActive = [document.getElementById('spa-home'), homepage, postsWrap, page404]
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  .find(el => el && (el.classList.contains('animate-slide') || el.style.display === 'block'));

Â  const runOriginalRouter = () => {
Â  Â  safe(debugBox, box => { box.innerHTML = `<b>[ROUTING]</b> Path: ${path}<br>`; });
Â  Â  const cleanPath = path.replace(/\/$/, "");
Â  Â  const cleanBlogPath = BLOG_PATH.replace(/\/$/, "");

Â  Â  if (cleanPath === cleanBlogPath || path.includes('blog.html')) return renderList(pushState);
Â  Â  if (cleanPath === '/' || cleanPath === '' || cleanPath === '/index.html') return renderHome(pushState);
Â  Â Â 
Â  Â  const post = findPostByPath(path);Â Â 
Â  Â  if (post) return renderPost(post, pushState);

Â  Â  render404(path, pushState);Â Â 
Â  };

Â  // LOGIKA ANIMASI KELUAR
Â  if (pushState && currentActive) {
Â  Â  currentActive.classList.remove('animate-slide');
Â  Â  currentActive.classList.add('animate-out');
Â  Â Â 
Â  Â  setTimeout(() => {
Â  Â  Â  window.scrollTo(0, 0);
Â  Â  Â  runOriginalRouter();
Â  Â  }, 300); // 300ms sesuai durasi animate-out di CSS
Â  } else {
Â  Â  runOriginalRouter();
Â  }
}

Â  /* ---------------- link interception ---------------- */

Â  document.querySelectorAll('a[href]').forEach(a => {Â Â 
Â  Â  a.addEventListener('click', e => {Â Â 
Â  Â  Â  const href = a.getAttribute('href');Â Â 
Â  Â  Â  if (!href || href.startsWith('#')) return;Â Â 
Â Â 
Â  Â  Â  const url = new URL(href, location.origin);Â Â 
Â  Â  Â  if (url.origin !== location.origin) return;Â Â 
Â Â 
Â  Â  Â  e.preventDefault();Â Â 
Â  Â  Â  router(url.pathname, true);Â Â 
Â  Â  });Â Â 
Â  });Â Â 
Â Â 
Â  if (btn) {Â Â 
Â  Â  btn.addEventListener('click', e => {Â Â 
Â  Â  Â  e.preventDefault();Â Â 
Â  Â  Â  router(BLOG_PATH, true);Â Â 
Â  Â  });Â Â 
Â  }Â Â 
Â Â 
Â  getPosts().forEach(p => {Â Â 
Â  Â  const a = p.querySelector('.post-title a');Â Â 
Â  Â  if (!a) return;Â Â 
Â  Â  a.addEventListener('click', e => {Â Â 
Â  Â  Â  e.preventDefault();Â Â 
Â  Â  Â  router(p.dataset.url, true);Â Â 
Â  Â  });Â Â 
Â  });Â Â 
Â Â 
Â  window.addEventListener('popstate', () => {Â Â 
Â  Â  router(location.pathname, false);Â Â 
Â  });Â Â 
Â Â 
Â  /* ---------------- debug overlay ---------------- */Â Â 
Â Â 
Â  function debug() {Â Â 
Â  Â  if (!debugBox) return;Â Â 
Â  Â  debugBox.innerHTML +=Â Â 
Â  Â  Â  `<hr><b>STATE:</b> ${STATE}<br>` +Â Â 
Â  Â  Â  `<b>PATH:</b> ${location.pathname}<br>`;Â Â 
Â  }Â Â 
Â Â 
Â  // klik overlay â†’ copy seluruh HTML debugÂ Â 
Â  if (debugBox) {Â Â 
Â  Â  debugBox.addEventListener('click', () => {Â Â 
Â  Â  Â  const htmlToCopy = debugBox.innerHTML;Â Â 
Â  Â  Â  navigator.clipboard.writeText(htmlToCopy).then(() => {Â Â 
Â  Â  Â  Â  debugBox.innerHTML += `<br><i>Copied debug overlay! ðŸ“‹</i>`;Â Â 
Â  Â  Â  });Â Â 
Â  Â  });Â Â 
Â  }Â Â 
Â Â 
Â  /* ---------------- init ---------------- */

// Hapus block if(location.pathname === BLOG_PATH) lama
// Cukup panggil router secara global
router(location.pathname, false);

});Â Â 
</script>
